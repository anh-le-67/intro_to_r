---
title: "intro to r project"
author: "jodi"
date: "2024-02-22"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, comment = "")
```

## 1 Cleaning

In this section, we aim to check for missing and duplicate values and remove columns that are insignificant in our univariate, bivariate and multivariate analysis.

We start off by loading libraries and importing the dataset we will be using for this analysis.

```{r}
library(dplyr)
library(tidyr)
Census_Income <- read.csv("adult.csv")
```

```{r}
# Replace '?' elements with NA
Census_Income <- data.frame(lapply(Census_Income, function(x) ifelse(x == '?', NA, x)))

# Drop columns native.country, capital.gain, capital.loss, relationship, and education.num
Census_Income <- subset(Census_Income, select = -c(native.country, capital.gain, capital.loss, relationship, education.num))

# Remove missing values from the column occupation
Census_Income <- Census_Income[complete.cases(Census_Income$occupation), ]

# Modify the income column to make it 1 if income is above 50k and 0 otherwise
Census_Income$income <- ifelse(Census_Income$income == '<=50K', 0, 1)
```

## 2 Basic visualisation

To decide on which variables we will focus on in our analysis, we will run some basic statistical tests on the numerical and categorical variables to understand them better.

```{r}
# Percentage of respondents with income > 50K
income_freq <- table(Census_Income$income)
barplot(income_freq, 
        main = "Income Distribution", 
        xlab = "Income Category", 
        ylab = "Frequency", 
        ylim = c(0, max(income_freq) + 1))
mean(Census_Income$income == 1)*100
```
```{r}
# Numerical variables
hist(Census_Income$age, main = "Age", xlab = "Age", ylab = "Frequency")
hist(Census_Income$hours.per.week, main = "Hours Worked", xlab = "Hours worked", ylab = "Frequency")

# Nominal variables
Census_Income %>%
  group_by(workclass) %>%
  summarise(income_level = sum(income == "0"))

Census_Income %>%
  group_by(education) %>%
  summarise(income_level = sum(income == "0"))

Census_Income %>%
  group_by(marital.status) %>%
  summarise(income_level = sum(income == "0"))

Census_Income %>%
  group_by(occupation) %>%
  summarise(income_level = sum(income == "0"))

Census_Income %>%
  group_by(race) %>%
  summarise(income_level = sum(income == "0"))

Census_Income %>%
  group_by(sex) %>%
  summarise(income_level = sum(income == "0"))
```

```{r}
# Correlation matrix of all numeric variables against income
library(corrplot)
CI_numeric <- Census_Income[, c("age", "hours.per.week", "income")]
corr_mat <- cor(CI_numeric)
corrplot(corr_mat, method = "number")
```
```{r}
# descriptive statistics of hours worked per week
summary(Census_Income$hours.per.week)
```

## 3 Univariate analysis
You can also embed plots, for example:

```{r}
# logistic regression of individual variables on income
# H0: independent variable has no impact on whether income is above 50K
# H1: independent variable has an impact on whether income is above 50K

library(tidyverse)
logit_age <- glm(income ~ age, 
             data = Census_Income, 
             family = "binomial")
summary(logit_age)

logit_sex <- glm(income ~ sex, 
             data = Census_Income, 
             family = "binomial")
summary(logit_sex)

logit_race <- glm(income ~ race, 
             data = Census_Income, 
             family = "binomial")
summary(logit_race)

logit_hours <- glm(income ~ hours.per.week, 
             data = Census_Income, 
             family = "binomial")
summary(logit_hours)
```

## 4 Multivariate analysis
You can also embed plots, for example:

```{r}
# multinomial logistic regression
logit <- glm(income ~ age + sex + race + hours.per.week, 
             data = Census_Income, 
             family = "binomial")
summary(logit)
```

## 5 Graphical representations
You can also embed plots, for example:

```{r}

```
